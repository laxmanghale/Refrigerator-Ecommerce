!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@ali/wpk-reporter")):"function"==typeof define&&define.amd?define(["exports","@ali/wpk-reporter"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).iLogger={},e.wpkReporter)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(t);function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,w(o.key),o)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(t.includes(o))continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,r,a,c=[],s=!0,l=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=r.call(n)).done)&&(c.push(o.value),c.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return c}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function m(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}var h,v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e;if(e.includes("?")){var o=p(e.split("?"),2)[1];n=void 0===o?"":o}if(n.includes("#")){var i=p(n.split("#"),1)[0];n=void 0===i?"":i}for(var r=n.split("&"),a={};r.length;){var c=p(r.shift().split("="),2),s=c[0],l=void 0===s?"":s,u=c[1],d=void 0===u?"":u;l&&(a[l]=t?decodeURIComponent(d):d)}return a},_=!1;function y(){var e=window.navigator.userAgent;return/Android/.test(e)?"android":/(iPhone|iPod)/.test(e)?"ios":/Windows\sPhone/.test(e)?"windows_phone":"unknown"}function b(e){return e.split(".").map((function(e){return parseInt(e,10)}))}function T(e){var t=function(){if(void 0!==h)return h;var e=navigator.userAgent.match(/AliApp\(LA\/(\d+.\d+.\d+)\)/);return h=e&&e.length>1?e[1]:""}();return!!function(e){return/^\d+(\.\d+)+$/.test(e)}(t)&&function(e,t){for(var n=b(e),o=b(t),i=0;i<Math.max(n.length,o.length);i++){if(n[i]>o[i])return 1;if(n[i]<o[i])return-1}return 0}(t,e)>=0}function S(e){return window.__PAGE_NAME?"".concat(window.__PAGE_NAME,"-").concat(e):e}function O(){return((arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||window.location.search.slice(1)).split("&").reduce((function(e,t){var n=p(t.split("="),2),o=n[0],i=n[1];return e[o]=i,e}),{})}function k(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=m(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw r}}}}(e.split("\r\n"));try{for(n.s();!(t=n.n()).done;){var o=t.value;if(o.indexOf("x-eagleeye-id")>-1){var i=o.split(":");return i[1]?i[1]:""}}}catch(e){n.e(e)}finally{n.f()}return""}function E(){return(navigator.userAgent||"").toLowerCase().indexOf("android")>-1}function x(){var e="",t=document.head.querySelector('meta[name="itrace-bid"]')||document.head.querySelector('meta[name="wpk-pid"]')||document.head.querySelector('meta[name="wpk-bid"]');return t&&t.getAttribute("content")&&(e=t.getAttribute("content")),e}function P(e){return!!e.includes("lazada")||(!!e.includes("daraz")||(!!e.includes("mirivia")||(!!e.includes("pages.shop.")||!!e.includes("www.shop."))))}var I="OTHER";function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST",n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,i=arguments.length>2?arguments[2]:void 0;!function(e){for(var t in e)void 0===e[t]&&delete e[t]}(e=Object.assign(Object.assign({},o),e));var r=e.group;Array.isArray(r)&&(e.group=r.join("|")),0!==i.indexOf("/")&&(i="/".concat(i));var a=Object.keys(e).map((function(t){return"".concat(t,"=").concat("string"==typeof e[t]?e[t]:JSON.stringify(e[t]))})).join("&");window.goldlog&&window.goldlog.record?window.goldlog.record(i,n||I,a,"POST"===t?"POST":"GET"):(window.goldlog_queue||(window.goldlog_queue=[])).push({action:"goldlog.record",arguments:[i,n||I,a,"POST"===t?"POST":"GET"]})}var L="/lazada-marketing.ug.benefit",C=["promotion_id","promotion_status","plan_id"],A=["tag_id","tag_union_id","promotion_source","promotion_allow_cnt","promotion_amount","discount_type","percent_amount","collect_id","offer_benefit_id","min_spend","cap_value","scene_id","app"],R=["is_auto_collect"],D=["exp_type"],N=function(){return c((function e(t){r(this,e),this.baseParams={};var n=this.basic_info_check(t);if(n.is_check)n.warnMessage&&console.warn(n.warnMessage),this.setbaseInfo(t);else if(n.errorMessage)throw new Error(n.errorMessage)}),[{key:"setbaseInfo",value:function(e){this.baseParams=Object.assign(Object.assign({},this.baseParams),e)}},{key:"getbaseInfo",value:function(){return this.baseParams}},{key:"benefit_info_check",value:function(e){var t=C.filter((function(t){return void 0===e[t]||""===e[t]})),n=A.filter((function(t){return void 0===e[t]||""===e[t]})),o=!0;return n&&n.length&&(console.warn("benefit info check failed, no ".concat(n.join(","),".")),o=!0),t&&t.length&&(console.error("benefit info check failed, no ".concat(t.join(","),".")),o=!1),o}},{key:"basic_info_check",value:function(e){var t=D,n=[],o=[];return R.forEach((function(t){Array.isArray(t)?t.some((function(t){return!(void 0===e[t]||""===e[t])}))||n.push.apply(n,f(t)):void 0!==e[t]&&""!==e[t]||n.push(t)})),t.forEach((function(t){Array.isArray(t)?t.some((function(t){return!(void 0===e[t]||""===e[t])}))||o.push.apply(o,f(t)):void 0!==e[t]&&""!==e[t]||o.push(t)})),n&&n.length?{is_check:!1,errorMessage:n.length>0?"benefit info check failed, no ".concat(n.join(","),"."):null}:o&&o.length?{is_check:!0,warnMessage:o.length>0?"benefit info check failed, no ".concat(o.join(","),"."):null}:{is_check:!0}}},{key:"init_log",value:function(){j({event_name:"init"},"POST",L,I,this.getbaseInfo())}},{key:"req_exp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};j(Object.assign(Object.assign({},e),{event_name:"req_exp"}),"POST",L,I,this.getbaseInfo())}},{key:"req_exp_callback",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};j(Object.assign(Object.assign({},e),{event_name:"req_exp_callback"}),"POST",L,I,this.getbaseInfo())}},{key:"poplayer_open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};j(Object.assign(Object.assign({},e),{event_name:"poplayer_open"}),"POST",L,I,this.getbaseInfo())}},{key:"manual_exp",value:function(e){var t=this.benefit_info_check(e);if(!t)return t;j(Object.assign(Object.assign({},e),{event_name:"exp"}),"POST",L,I,this.getbaseInfo())}},{key:"toggle_max",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};j(Object.assign(Object.assign({},e),{event_name:"toggle_max"}),"POST",L,I,this.getbaseInfo())}},{key:"toggle_min",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};j(Object.assign(Object.assign({},e),{event_name:"toggle_min"}),"POST",L,I,this.getbaseInfo())}},{key:"collect_click",value:function(e){var t=this.benefit_info_check(e);if(!t)return t;j(Object.assign(Object.assign({},e),{event_name:"collect_click"}),"POST",L,I,this.getbaseInfo())}},{key:"collect_callback",value:function(e){var t=this.benefit_info_check(e);if(!t)return t;j(Object.assign(Object.assign({},e),{event_name:"collect_callback"}),"POST",L,I,this.getbaseInfo())}}])}(),M=function(){return c((function e(t){var n=this;r(this,e),this.getSpm=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"".concat(n.getSpmAB().spmA,".").concat(n.getSpmAB().spmB,".").concat(e||n.spmC||0,".").concat(t||n.spmD||0)},this.getSpmLink=function(e,t,o){if(!e)return e;var i="spm=".concat(n.getSpm(t||n.spmC,o||n.spmD)),r=p(e.split("#"),2),a=r[0],c=r[1],s=p(a.split("?"),2)[1],l=((void 0===s?"":s).match(/(.*?)=(.*?)(&|$)/g)||[]).map((function(e){return"&"===e[e.length-1]?e.substring(0,e.length-1):e})).reduce((function(e,t){var n=t.match(/(.*)=(.*)/);return e[n[1]]=n[2],e}),{});if(l.spm)return e;var u=a;return a.indexOf("?")>-1?Object.keys(l).length>0?u+="&".concat(i):u+="".concat(i):u+="?".concat(i),c&&(u+="#".concat(c)),u},t.benefitOptions&&(this.benefit=new N(Object.assign(Object.assign({},t.benefitOptions),{module:t.module}))),this.baseParams={},this.initSpm(t.spm),this.setbaseInfo(t)}),[{key:"setbaseInfo",value:function(e){this.baseParams=Object.assign(Object.assign({},this.baseParams),e)}},{key:"getbaseInfo",value:function(){return this.baseParams}},{key:"initSpm",value:function(e){var t,n,o,i,r,a;if(e){var c=e.split(".");switch(c.length){case 1:this.spmC=c[0];break;case 2:this.spmC=c[0],this.spmD=c[1];break;case 3:this.spmA=c[0],this.spmB=c[1],this.spmC=c[2];break;case 4:this.spmA=c[0],this.spmB=c[1],this.spmC=c[2],this.spmC=c[3]}}this.spmA=this.spmA||(null===(t=null===window||void 0===window?void 0:window.$pegasus)||void 0===t?void 0:t.spma)||(null===(o=null===(n=null===window||void 0===window?void 0:window.g_config)||void 0===n?void 0:n.pageInfo)||void 0===o?void 0:o.spma),this.spmB=this.spmB||(null===(i=null===window||void 0===window?void 0:window.$pegasus)||void 0===i?void 0:i.spmb)||(null===(a=null===(r=null===window||void 0===window?void 0:window.g_config)||void 0===r?void 0:r.pageInfo)||void 0===a?void 0:a.spmb)}},{key:"getSpmAB",value:function(){return{spmA:this.spmA,spmB:this.spmB}}},{key:"moduleExp",value:function(e){if(!(null==e?void 0:e.spm_c))throw new Error("module exp error, no spmC ");j(Object.assign(e,{spm:"".concat(this.spmA,".").concat(this.spmB,".").concat(e.spm_c||this.spmC)}),"POST","/lzd.aplus-module-manual.exp","EXP",this.getbaseInfo())}},{key:"expo",value:function(e){var t,n,o,i=null===(t=null==e?void 0:e.spm_cd)||void 0===t?void 0:t.split(".");i.length>1?(n=i[0]||this.spmC,o=i[1]||this.spmD):(i.length=1)&&(n=this.spmC,o=i[0]||this.spmD),j(Object.assign(e,{spm:"".concat(this.spmA,".").concat(this.spmB,".").concat(n,".").concat(o),event_name:e.event_name||"expose"}),"POST","/lzd.aplus-manual.exp","EXP",this.getbaseInfo())}},{key:"click",value:function(e){var t,n,o,i=null===(t=null==e?void 0:e.spm_cd)||void 0===t?void 0:t.split(".");i.length>1?(n=i[0]||this.spmC,o=i[1]||this.spmD):(i.length=1)&&(n=this.spmC,o=i[0]||this.spmD),j(Object.assign(e,{spm:"".concat(this.spmA,".").concat(this.spmB,".").concat(n,".").concat(o,"}"),event_name:e.event_name||"click"}),"POST","/lzd.aplus-manual.clk","CLK",this.getbaseInfo())}},{key:"other",value:function(e){var t;if(!(null==e?void 0:e.event_name))throw new Error("error, no event_name");var n,o,i=(null===(t=null==e?void 0:e.spm_cd)||void 0===t?void 0:t.split("."))||[];i.length>1?(n=i[0]||this.spmC,o=i[1]||this.spmD):(i.length=1)&&(n=this.spmC,o=i[0]||this.spmD),j(Object.assign(e,{spm:"".concat(this.spmA,".").concat(this.spmB,".").concat(n,".").concat(o)}),"POST","/lzd.aplus-manual.other",I,this.getbaseInfo())}}])}(),z=["group","biz","event"],q=new M({spm:"",module:"",bizname:""});function F(e){var t=e.group,n=e.biz,o=e.event,i=d(e,z);q.other({spm_cd:"",module:"",group:t||"h5-itrace-sdk",bizname:n||"",event_name:o||"",user_data:u({},i)})}var H=0,B=0;function K(e,t,n,o){var i=function(e,t){return t||(H=H||performance.timeOrigin,e?e-H:+new Date-H-0)}(e,t),r=+new Date;B=performance.now()||0,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!(window.WindVane||{}).isAvailable)return!1;var o=location,i=o.origin+o.pathname;i=window.__SSR_STATUS__?o.search?i+o.search+"&pageType=SourcePageSSR"+o.hash:i+"?pageType=SourcePageSSR"+o.hash:location.href,window.WindVane&&window.WindVane.call("LACustomWVPlugin","reportPerformanceInfo",{webViewType:n,url:i,containerType:"object"===g(window.__pha_environment__)?1:0,firstScreenPaint:e,firstScreenPaintTimeStamp:t},(function(){console.log("[component_did_mount_hook] report time to App",e)}),(function(e){console.log("err",e)}))}(i,r),function(e,t,n,o){window.__wpk&&window.__wpk.report&&(window.__wpk.report(Object.assign({category:203,msg:S("componentDidMount"),wl_avgv1:e,c1:e,c2:H,c3:t||"-",c4:0,c5:B,c6:window.__SSR_STATUS__?"SourcePageSSR":""},o)),console.log("[component_did_mount_hook] report time to iTrace",e))}(i,r,0,o)}window.__WindVane=window.WindVane||{};var W=function(){window.lzdiTraceLifeCircle=Object.assign({},window.lzdiTraceLifeCircle),window.lzdiTraceLifeCircle.lzdiTraceShareDidMountTime=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(window.rocket_pre_hot)return null;"function"==typeof window.clearTraceLifeQueue&&window.clearTraceLifeQueue(),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"POST";0!==e.indexOf("/")&&(e="/".concat(e));var i=Object.keys(n).map((function(e){return"".concat(e,"=").concat("string"==typeof n[e]?n[e]:JSON.stringify(n[e]))})).join("&");window.goldlog&&window.goldlog.record?window.goldlog.record(e,t,i,"POST"===o?"POST":"GET"):(window.goldlog_queue||(window.goldlog_queue=[])).push({action:"goldlog.record",arguments:[e,t,i,"POST"===o?"POST":"GET"]})}("/lzdfe.pageModule.exp","EXP"),K(e,t,0,n),window.lzdiTraceLifeCircle&&window.lzdiTraceLifeCircle.FirstScreenRenderingEnd()},window.lzdiTraceLifeCircle&&window.lzdiTraceLifeCircle.FirstScreenRenderingStart()},G=function(e){if("unknown"!==y()&&("ios"!==y()||T("7.2.0"))&&("android"!==y()||T("7.3.0"))&&window.WindVane)try{window.WindVane.call("LAWVNexpInfo","reportNexpInfo",e,(function(){console.log("reportNexpInfo:",e)}),(function(e){console.warn("reportNexpInfo failed:",e)}))}catch(e){console.error("report badcase error:",e)}},U=function(e){return Math.random()<e},J=function(e){return"string"==typeof e?parseInt(e):e},V={},X=[],Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(T("7.4.0"))if("function"==typeof window.clearTraceLifeQueue&&window.clearTraceLifeQueue(),window.WindVane){(e=[].concat(e)).forEach((function(e){if(e.event&&e.time&&(V[e.event]=e.time,"first_screen_rendering_end"===e.event&&e.costTime>3e3||"fsp_end"===e.event&&e.costTime>5e3)){var t=O();G({module:"h5_perf",subModule:window.location.href,info:u(u({},e),{},{query:t,timeline:V})})}}));try{window.WindVane.call("LACustomWVPlugin","reportLifecycle",{lifecycles:e},(function(){console.log("reportLifecycle:",e)}),(function(e){console.warn("reportLifecycle failed:",e)}))}catch(e){console.error("report lifecyle error:",e)}}else X.push(e)},$=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e?null:{},o=document.cookie?document.cookie.split("; "):[],i=/(%[0-9A-Z]{2})+/g,r=0;r<o.length;r++){var a=o[r].split("="),c=a.slice(1).join("=");t.json||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var s=a[0].replace(i,decodeURIComponent);if(c=c.replace(i,decodeURIComponent),t.json)try{c=JSON.parse(c)}catch(e){}if(e===s){n=c;break}e||(n[s]=c)}catch(e){}}return n},Q=navigator.userAgent;v();"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function Z(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ee={exports:{}};!function(e){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==g(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",quark:"http://px.wpk.quark.cn/api/v1/jssdk/upload",quark_https:"https://px.wpk.quark.cn/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload",qg:"http://px-itrace.xuexi.cn/api/v1/jssdk/upload",qg_https:"https://px-itrace.xuexi.cn/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig",qg:"http://px-itrace.xuexi.cn/api/v1/jconfig",qg_https:"https://px-itrace.xuexi.cn/api/v1/jconfig",quark:"http://px.wpk.quark.cn/api/v1/jconfig",quark_https:"https://px.wpk.quark.cn/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3,MAINDOC:1e5,RESTIMING:100001},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},,,function(e,t,n){var o=n(0).env,i=function(e){var t;return(e&&(t=e.replace(/^#\/?/,""))&&"string"==typeof t?t.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):"")||"[index]"},r=function(e,t){if(t=t||{},e.env===o.BROWSER&&window)if(e.toolKit.extend({enable:!0},t).enable){e.logger.info("wpkflowPlugin已开启");var r,a,c=function(){e.reportFlow()};e.toolKit.isPageReady(e.prerender)?setTimeout(c,0):e.toolKit.onPageReady(c,!0,e.prerender),e.spa&&(n(4)(),r=function(t){i(location.hash)&&(e._begin=Date.now(),e._sid=e.toolKit.getSessionId(),e.reportFlow())},a=function(t){i(t.detail)&&(e._begin=Date.now(),e._sid=e.toolKit.getSessionId(),e.reportFlow())},e.toolKit.onListen(window,"hashchange",r),e.toolKit.onListen(window,"historystatechange",a)),e.toolKit.onListen(window,"beforeunload",(function(){e.toolKit.offListen(window,"load"),e.toolKit.offListen(window,"hashchange"),e.toolKit.offListen(window,"historystatechange"),c=r=a=null}))}else e.logger.info("wpkflowPlugin已关闭")};r.prototype.pluginId="flow",e.exports=r},function(e,t){var n=window.history||{},o=window.document,i=function(e,t){var n;window.CustomEvent?n=new CustomEvent(e,{detail:t}):((n=o.createEvent("HTMLEvents")).initEvent(e,!1,!0),n.detail=t),window.dispatchEvent(n)},r=function(e){return e&&"string"==typeof e?e.replace(/^(https?:)?\/\//,"").replace(/\?.*$/,""):""},a=function(e){var t=n[e];"function"==typeof t&&(n[e]=function(e,o,a){var c=location.href,s=t.call(n,e,o,a);if(!a||"string"!=typeof a)return s;if(a===c)return s;try{var l=c.split("#"),u=a.split("#"),d=r(l[0]),p=r(u[0]),f=l[1]&&l[1].replace(/^\/?(.*)/,"$1"),w=u[1]&&u[1].replace(/^\/?(.*)/,"$1");d!==p?i("historystatechange",p):f!==w&&i("historystatechange",w)}catch(e){}return s},n[e].toString=e+"() { [native code] }")};e.exports=function(){a("pushState"),a("replaceState")}}])}(ee);var te=Z(ee.exports),ne={exports:{}};!function(e){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==g(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}({0:function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",quark:"http://px.wpk.quark.cn/api/v1/jssdk/upload",quark_https:"https://px.wpk.quark.cn/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload",qg:"http://px-itrace.xuexi.cn/api/v1/jssdk/upload",qg_https:"https://px-itrace.xuexi.cn/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig",qg:"http://px-itrace.xuexi.cn/api/v1/jconfig",qg_https:"https://px-itrace.xuexi.cn/api/v1/jconfig",quark:"http://px.wpk.quark.cn/api/v1/jconfig",quark_https:"https://px.wpk.quark.cn/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3,MAINDOC:1e5,RESTIMING:100001},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},6:function(e,t,n){var o=n(0),i=o.sdk,r=o.http.methods,a=o.category,c=function(e){return e>=200&&e<=299},s=function(e){return-1===e.indexOf("//arms-retcode")&&-1===e.indexOf("//retcode.taobao.com")&&-1===e.indexOf("aliyuncs.com/r.png")&&-1===e.indexOf("//mdap.alipay.com/loggw")&&-1===e.indexOf("//wpk-gateway")&&-1===e.indexOf("//px.wpk.quark.cn")&&-1===e.indexOf("//px.ucweb.com")&&-1===e.indexOf("//px.effirst.com")&&-1===e.indexOf("//px-intl.ucweb.com")&&-1===e.indexOf("//gm.mmstat.com/arms.1.1")&&-1===e.indexOf("//gm.mmstat.com/arms.1.2")&&-1===e.indexOf("//g.alicdn.com/alilog")&&-1===e.indexOf("//log.m.sm.cn/0.gif")},l=function(e,t){if(e.hasOwnProperty(t))return e[t]},u=function(e,t,n){e.toolKit.isObject(n)&&e.toolKit.extend(t,{c1:l(n,"c1"),c2:l(n,"c2"),c3:l(n,"c3"),c4:l(n,"c4"),c5:l(n,"c5"),bl1:l(n,"bl1"),bl2:l(n,"bl2"),bl3:l(n,"bl3"),bl4:l(n,"bl4"),bl5:l(n,"bl5")}),e.report(t)},d=location.origin,p=function(e){return!e||0===e.indexOf(d)||!/^(\/\/|http:|https:).*/.test(e)};function f(e,t){var n=null;try{var o,i,r,a=e.toolKit.trim(t||"").split(/[\r\n]+/);a.length>0&&(n={},e.toolKit.forEach(a,(function(e){o=e.split(": "),i=o.shift(),r=o.join(": "),n[i]=r})))}catch(e){}return n}function w(e){try{if(!e)return{};var t={};return e.forEach((function(e,n){t[n]=e})),t}catch(e){return{}}}var g=function(e,t){if(e.env===o.env.BROWSER&&window){var n={enable:!0,sampleRate:1,enableTrace:!1,enableCorsTrace:function(e){return!1},requestHeaders:{"x-wpk-reqid":function(){return e.toolKit.uuid(!1)},"x-wpk-bid":function(){return e.bid}},responseHeaders:["x-eagleeye-id","x-wpk-serverid"]},l=e.toolKit.extend(n,t);l.enable?(e.logger.info("wpkinterfacePlugin已开启"),"XMLHttpRequest"in window&&function(e,t){var n=window.XMLHttpRequest.prototype,o=n.open;n.open=function(n,i){this.__reqCtx__={method:n,url:i||"",start:Date.now()};var r=[].slice.call(arguments);o.apply(this,r);var a=this;t.enableTrace&&(p(i)||t.enableCorsTrace(i))&&e.toolKit.forEach(Object.getOwnPropertyNames(t.requestHeaders),(function(e){var n=t.requestHeaders[e]();a.setRequestHeader(e,n)}))};var l=n.setRequestHeader;n.setRequestHeader=function(e,t){var n=[].slice.call(arguments);l.apply(this,n),this.__reqCtx__&&(this.__reqCtx__.headers||(this.__reqCtx__.headers={}),this.__reqCtx__.headers[e]=t)};var d=n.send;n.send=function(n){var o=this;function l(){if(o.__reqCtx__&&4===o.readyState)try{var l=Date.now(),d=(o.responseURL||o.__reqCtx__.url).split("?"),p=d[0],w=d[1]||"",g="",m=o.__reqCtx__.headers||{};o.__reqCtx__.method.toUpperCase()!==r.GET&&n&&(g=JSON.stringify(n));var h=f(e,o.getAllResponseHeaders()),v=String(o.response),_=!0,y={};"function"==typeof t.errorFilter&&(_=!!(y=t.errorFilter.call(this,{url:p,status:o.status,response:v,body:g,queryString:w,reqHeaders:m,resHeaders:h})),e.logger.warn("api errorFilter执行结果：",y)),v.length>2048&&(v="[response content too large]");var b=l-o.__reqCtx__.start;if(_&&b<121e3&&s(p)){var T=y.bizCode||o.status,S=y.reqHeaders||m,O=y.resHeaders||h,k={category:a.API,sampleRate:t.sampleRate,w_res:p,w_param:w,w_body:c(T)||!t.withBody?"":g,w_method:o.__reqCtx__.method,w_rc:T,w_rt:b,w_resp:c(T)||!t.withResp?"":y.resp||v,w_hd:JSON.stringify(S),w_trace_reqid:S&&S["x-wpk-reqid"]||void 0,w_rshd:JSON.stringify(O),w_trace_serverid:O&&O["x-wpk-serverid"]||void 0,msg:y.msg||"",w_type:16};u(e,k,y)}}catch(t){e.reportError(t,{bid:i.BID,cid:i.CID,category:a.JSERR,sampleRate:1})}}if("onreadystatechange"in o&&"function"==typeof o.onreadystatechange){var p=o.onreadystatechange;o.onreadystatechange=function(){var e=[].slice.call(arguments);l.apply(this,e),p.apply(this,e)}}else o.onreadystatechange=l;var w=[].slice.call(arguments);return d.apply(this,w)}}(e,l),"fetch"in window&&function(e,t){var n=function(e){var t=(e||"").split("?");return{apiAddr:t[0],queryString:t.length>1&&t[1]||""}},o=function(n,o,i,r,s,l,u,d,p,f,w){var g=e.toolKit.isObject(d)?d:{},m=g.reqHeaders||l,h=g.resHeaders||u;return{w_res:n,w_param:o,w_method:i,w_rc:s,w_rt:r,w_hd:JSON.stringify(m),w_trace_reqid:m&&m["x-wpk-reqid"]||void 0,w_rshd:JSON.stringify(h),w_trace_serverid:h&&h["x-wpk-serverid"]||void 0,msg:g.msg||p||"",w_body:c(s)||!t.withBody?"":f,w_resp:c(s)||!t.withResp?"":g.resp||w||"",category:a.API,sampleRate:t.sampleRate,w_type:17}},l=function(n,o,i,r,a,c,s){var l={};return"function"==typeof t.errorFilter&&(l=t.errorFilter.call(this,{url:n,queryString:o,status:i,body:r,response:a,reqHeaders:c,resHeaders:s}),e.logger.warn("api errorFilter执行结果：",l)),l},d=window.fetch;window.fetch=function(){var c=[].slice.call(arguments),f=r.GET;c[1]&&c[1].method&&(f=c[1].method.toUpperCase());var g,m=c[0];g="string"==typeof m?m:m instanceof URL?m.toString():m.url||"",t.enableTrace&&(p(g)||t.enableCorsTrace(g))&&(c[1]?void 0===c[1].headers&&(c[1].headers={}):c[1]={headers:{}},e.toolKit.forEach(Object.getOwnPropertyNames(t.requestHeaders),(function(e){c[1].headers[e]=t.requestHeaders[e]()})));var h=Date.now(),v="",_=null;return c[1]&&(_=c[1].headers),f!==r.GET&&c[1]&&c[1].body&&(v=JSON.stringify(c[1].body)),d.apply(this,c).then((function(t){try{var r=Date.now(),d=n(t.url||c[0]),p=d.apiAddr,g=d.queryString,m=t.clone(),y=w(m.headers);m.text().then((function(n){n=n||"";var i=l.call(this,p,g,t.status,v,n,_,y),a=!!i;n=n.length>2048?"[response content too large]":n;var c=r-h;if(a&&c<121e3&&s(p)){var d=i.bizCode||t.status,w=o(p,g,f,c,d,_,y,i,void 0,v,n);u(e,w,i)}}))}catch(t){e.reportError(t,{bid:i.BID,cid:i.CID,category:a.JSERR,sampleRate:1})}return t})).catch((function(t){var i=n(c[0]),r=i.apiAddr,a=i.queryString,d=l.call(this,r,a,-1,v,"",_,{}),p=!!d,w=Date.now()-h;if(p&&w<121e3&&s(r)){var g=d.bizCode||-1,m=o(r,a,f,w,g,_,{},d,t.message,v,void 0);u(e,m,d)}throw t}))}}(e,l),(e.enableMtop||l.enableMtop)&&(e.logger.info("use mtop"),function(e,t){window&&window.lib.mtop&&window.lib.mtop.middlewares&&window.lib.mtop.middlewares.push((function(n){var o=this.params,r=this.options,l=Date.now();return n().then((function(){try{if(r.H5Request&&(r.getJSON||r.postJSON))return void e.logger.debug("识别到请求为xhr, api监控交由xhr的方式处理");var n,d=r.retJson||{},p=Date.now()-l,f=d.code||200,w=o.type,g=o.api,m=e.toolKit.objToQueryString(r.querystring),h=r.postdata&&r.postdata.data?e.toolKit.objToJsonString(r.postdata.data):null,v=e.toolKit.objToJsonString(d.data||{}),_=d.ret;_ instanceof Array&&(_=_.join(",")),-1===_.indexOf("SUCCESS")&&(n=_);var y=!0,b={};if("function"==typeof t.errorFilter&&(y=!!(b=t.errorFilter.call(this,{url:g,status:f,response:v,body:h,queryString:m,msg:n})),e.logger.warn("api errorFilter执行结果：",b)),y&&p<121e3&&s(g)){var T=b.bizCode||f,S={category:a.API,sampleRate:t.sampleRate,w_res:g,w_param:m,w_body:c(T)||!t.withBody?"":h,w_method:w,w_rc:T,w_rt:p,w_resp:c(T)||!t.withResp?"":b.resp||v,msg:b.msg||n||"",w_type:100};u(e,S,b)}}catch(t){e.reportError(t,{bid:i.BID,cid:i.CID,category:a.JSERR,sampleRate:1})}}))}))}(e,l))):e.logger.info("wpkinterfacePlugin已关闭")}};g.prototype.pluginId="api",e.exports=g}})}(ne);var oe=Z(ne.exports),ie={exports:{}};!function(e){e.exports=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==g(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports={sdk:{BID:"wpkreporter",CID:"jssdk",WID_KEY:"__wpkreporterwid_"},env:{BROWSER:"browser",NODEJS:"nodejs",WEEX:"weex"},px:{signKey:"Uvn#08uefVdwe&c4",addr:{cn:"http://px.effirst.com/api/v1/jssdk/upload",cn_https:"https://px.effirst.com/api/v1/jssdk/upload",quark:"http://px.wpk.quark.cn/api/v1/jssdk/upload",quark_https:"https://px.wpk.quark.cn/api/v1/jssdk/upload",intl:"http://px-intl.ucweb.com/api/v1/jssdk/upload",intl_https:"https://px-intl.ucweb.com/api/v1/jssdk/upload",qg:"http://px-itrace.xuexi.cn/api/v1/jssdk/upload",qg_https:"https://px-itrace.xuexi.cn/api/v1/jssdk/upload"},confAddr:{cn:"http://px.effirst.com/api/v1/jconfig",cn_https:"https://px.effirst.com/api/v1/jconfig",intl:"http://px-intl.ucweb.com/api/v1/jconfig",intl_https:"https://px-intl.ucweb.com/api/v1/jconfig",qg:"http://px-itrace.xuexi.cn/api/v1/jconfig",qg_https:"https://px-itrace.xuexi.cn/api/v1/jconfig",quark:"http://px.wpk.quark.cn/api/v1/jconfig",quark_https:"https://px.wpk.quark.cn/api/v1/jconfig"}},http:{methods:{GET:"GET",PUT:"PUT",POST:"POST",HEAD:"HEAD",DELETE:"DELETE",OPTIONS:"OPTIONS",CONNECT:"OPTIONS",TRACE:"OPTIONS",PATCH:"OPTIONS"},protocols:{HTTP:"http:",HTTPS:"https:"}},category:{JSERR:1,API:2,JSFSPERF:3,RESLOADFAIL:4,FLOW:5,BKPG:6,HARLOG:7,PERFNEXT:1e3,MAINDOC:1e5,RESTIMING:100001},navConn:{types:{BLUETOOTH:"bluetooth",CELLULAR:"cellular",ETHERNET:"ethernet",MIXED:"mixed",NONE:"none",OTHER:"other",UNKNOWN:"unknown",WIFI:"wifi",WIMAX:"wimax"},effectiveTypes:{"2G":"2g","3G":"3g","4G":"4g",SLOW2G:"slow-2g"}}}},function(e,t,n){var o=n(0),i=function(e,t){if(e.env===o.env.BROWSER&&"undefined"!=typeof window){var n={enable:!0,sampleRate:(t=t||{}).sampleRate||1,rootNode:t.rootNode,ignorePageUrls:t.ignorePageUrls||null,maxDepth:t.maxDepth||8,minElements:t.minElements||10,keyNoteText:t.keyNoteText||[],onloadDuration:t.onloadDuration||8e3,wsDuration:t.wsDuration||3e3,startCheckingTime:t.startCheckingTime||5e3},i=e.toolKit.extend(n,t);if(i.enable){e.logger.info("wpkblankPagePlugin已开启");try{if(e.toolKit.isFunction(i.ignorePageUrls)&&i.ignorePageUrls(location))return void e.logger.info("当前页面在白屏检测的白名单中")}catch(e){}var r=!1;if(i.onloadDuration>0&&"complete"!==document.readyState&&!e.prerender)var a=setTimeout((function(){r=!0,e.reportBlankPage({w_fp:100,w_wst:i.onloadDuration}),clearTimeout(a)}),i.onloadDuration);var c=function(){clearTimeout(a);try{!r&&i.wsDuration>0&&function(e,t){var n=performance.timing;if("function"==typeof window.PerformanceNavigationTiming)try{var o=performance.getEntriesByType("navigation")[0];o&&(n=o)}catch(e){}if(n)try{n.responseEnd-n.fetchStart>=e&&t()}catch(e){}}(i.wsDuration,(function(){e.reportBlankPage({w_fp:104,w_wst:i.wsDuration})}));var t=setTimeout((function(){!function(e,t){var n,i,r,a,c,s=0,l=0,u=!1,d=[],p=function(e){return 0===e.style.width||0===e.style.height||"none"===e.style.display||0===e.style.opacity||"hidden"===e.style.visibility||"collapse"===e.style.visibility||void 0!==e.type&&"hidden"===e.type},f=function(e){return e&&-1!==["VIDEO","IMG","BUTTON","TEXTAREA","RADIO","CHECKBOX","SELECT","IFRAME","CANVAS","SVG"].indexOf(e.nodeName)},w=function(n,o){for(var i=Array.prototype.slice.call(n);i.length;){var r=i.shift();o>s&&(s=o),d.push({tag:r.tagName,layer:o,cls:r.className});var a=p(r);if(e.logger.info("depth："+o,r.nodeType,r.tagName,a),!a){if(l++,f(r)){u=!0,e.logger.info("有可见元素，非白屏");break}o<=t.maxDepth&&!p(r)&&r.children.length&&w(r.children,o+1)}}},g=!1;if(i=t.rootNode?"function"==typeof t.rootNode?t.rootNode():t.rootNode:document.body)if(r=i.innerText)a=t.keyNoteText,c=r,e.toolKit.some(a,(function(e){return e===c}))?(g=!0,n=102,e.logger.warn("肯定白屏，命中关键字",r)):(g=!1,u=!0);else{var m=Array.prototype.slice.call(i.children),h=e.toolKit.filter(m,(function(e){return-1===["STYLE","SCRIPT","LINK"].indexOf(e.nodeName)}));w(h,1)}else g=!0,n=103,e.logger.warn("白屏，木有body标签或者指定的root节点为空");e.logger.warn("元素数: ",l),e.logger.warn("遍历的最大层级: ",s),e.logger.warn("dsl",d),!g&&!u&&l<t.minElements&&(g=!0,n=101),g&&(e.logger.warn("白屏了",n),e.reportBlankPage({w_fp:n,w_dsl:JSON.stringify(d),w_depth:s,w_domcnt:l}),e.report({category:o.category.MAINDOC,sampleRate:1,bl1:JSON.stringify(document.documentElement.innerHTML),_forcePost:!0}),!e._hasCollectResTiming&&performance&&"function"==typeof performance.getEntriesByType&&(e.report({category:o.category.RESTIMING,bl1:JSON.stringify(performance.getEntriesByType("resource")),bl2:performance.timeOrigin||performance.timing.fetchStart,_forcePost:!0}),e._hasCollectResTiming=!0))}(e,i),clearTimeout(t)}),i.startCheckingTime)}catch(t){e.logger.error("bkpg checking oops: ",t)}};e.toolKit.onPageReady(c,!0,e.prerender),e.toolKit.onListen(window,"beforeunload",(function(){e.toolKit.offListen(window,"load"),c=null}))}else e.logger.info("wpkblankPagePlugin已关闭")}};i.prototype.pluginId="bkpg",e.exports=i}])}(ie);var re,ae,ce=Z(ie.exports),se=E(),le=function(){se||window.isTrace2||document.addEventListener("DOMContentLoaded",(function(){window.__wpk.addPlugin(ce,{rootNode:document.getElementById("container")||document.getElementById("root")})}))},ue=x(),de=(re=document.head.querySelector('meta[name="wpk-rel"]'))&&re.getAttribute("content")?re.getAttribute("content"):"",pe=function(){var e=document.head.querySelector('meta[name="wpk-sampleRate"]');return e&&e.getAttribute("content")?Number(e.getAttribute("content")):""}(),fe=v(),we=!!(ae="object"===("undefined"==typeof location?"undefined":g(location))&&location.hostname||"")&&(ae.indexOf("i.lazada.")>=0||ae.indexOf("-p.lazada.")>=0||ae.indexOf("pre-wormhole.")>=0||ae.indexOf("pre.lazada.")>=0||ae.indexOf("pre-www.lazada.")>=0||ae.indexOf("pre-wallet-nav.lazada.")>=0||ae.indexOf("-staging.lazada.")>=0)&&fe.iTraceDebug,ge=location.pathname.includes("/wow/i/sg/o2o-test/");var me={bid:ue,cid:"",uid:$("lzd_uid"),utdid:$("utdid"),rel:de||"2.0.39",sampleRate:pe||1,cluster:"intl",debug:we||ge,beforeSend:function(e){var t,n;n=!1,1===(t=e).category&&U(.01)&&(n=!0),2===t.category&&200!==t.w_rc&&U(.1)&&(n=!0),4===t.category&&U(.1)&&(n=!0),200===t.category&&J(t.c1)>5e3&&(n=!0),202===t.category&&J(t.wl_avgv1)>6e3&&(n=!0),n&&G({module:"h5_itrace",subModule:t.w_bid,info:u({},t)});var o,i,r,a=(i=(v()||{}).wh_pid||"",r=(null===(o=window)||void 0===o||null===(o=o.__SCREEN_DATAS)||void 0===o||null===(o=o[0])||void 0===o||null===(o=o.modules)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.version)||"",i&&/\/paylater(-test)?\/|\/cashloan(-test)?\/|\/credit-seller(-test)?\/|\/lazpay-warchest(-test)?\/|\/lazpay-page-module(-test)?\/|\/ewallet-h5(-test)?\/|\/dg-fe/.test(i)?r:"");a&&(e.rel=a,window.__wpk.setConfig({rel:a}));var c=(window.lzdiTraceLifeCircle||{}).lzdiTraceBeforeSend;try{return e&&c&&"function"==typeof c&&(e=c(e)),e}catch(t){return console.error("iTrace sdk beforeSend Format function execute error",t),e}}},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"boolean"==typeof e.isDebug&&(e.debug=e.isDebug),e.pid&&(e.bid=e.pid),Object.assign({},me,e)},ve=/AliApp/.test(Q),_e=E(),ye=!!document.querySelector("meta[name='wpk-bid']"),be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(P(location.host))if(e.pid){if(window.isTrace2)return Te(e);if("function"==typeof window.wpkReporter){var t=null;if(window.__wpk)e.pid&&(e.bid=e.pid,delete e.pid),window.__wpk.setConfig(e),t=window.__wpk;else{if(ye&&ve&&_e){var n=he(u(u({},e),{},{plugins:[[te,{enable:!1}]]}));(t=new o.default(n)).install()}else{var i=he(u(u({},e),{},{plugins:[[oe,{enable:!1}]]}));(t=new o.default(i)).installAll(),le()}window.__wpk=t}return console.log("lzd-h5-itrace version: v".concat("2.0.39")),t}console.warn("wpk-reporter is not ready.")}else console.warn("[lzd-h5-itrace] 实例化失败，缺少必要参数");else console.warn("[lzd-h5-itrace] 非法域名")},Te=function(){var e=he(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return window.__wpk.setConfig(e),window.__wpk},Se=!1,Oe=function(e){if(!Se){var t=function(e){var t=e.name,n=e.duration,o=void 0===n?0:n,i=e.decodedBodySize,r=void 0===i?0:i,a=e.encodedBodySize,c=void 0===a?0:a,s=e.transferSize,l=void 0===s?0:s;try{var u=new URL(t);window.__wpk.report({category:202,msg:u.hostname,wl_avgv1:o.toFixed(2),wl_avgv2:r,wl_avgv3:c,wl_avgv4:l,c1:t,bl5:JSON.stringify(e),sampleRate:.01})}catch(e){}},n=function(e){var n=function(e){try{var t=new URL(e.name);return"https:"!==t.protocol&&"http:"!==t.protocol||"img"!==e.initiatorType||(n=t.hostname).includes("member.lazada.")||n.includes("my.lazada.")||n.includes("www.lazada.")||n.includes("pages.lazada.")||n.includes("c.lazada.")||n.includes("www.google.")||n.includes("translate.google.")||n.includes("criteo.net")||n.includes("doubleclick.net")||n.includes("googleadservices")||n.includes("cnzz.com")||n.includes("log.aliyuncs.com")||n.includes("mmstat.")||n.includes("clarity")||n.includes("ucweb.com")||n.includes("googleapis")||-1!==["graph.facebook.com","connect.facebook.net","csi.gstatic.com","airunit.taobao.com","acjs.aliyun.com","whos.amung.us","kcart.alipay.com","www.google-analytics.com","px-intl.ucweb.com","www.googletagmanager.com","googleads.g.doubleclick.net","www.facebook.com","gm.mmstat.com","sg.mmstat.com","bat.bing.com","cm.everesttech.net","pixel.everesttech.net","retcode-sg-lazada.arms.aliyuncs.com","fourier.taobao.com","pixel.tapad.com","secure.adnxs.com","s-cs.send.microad.jp","cs.adingo.jp"].indexOf(n)?null:e}catch(t){console.log("invalid url",e)}var n;return null}(e);n&&(window.requestIdleCallback?window.requestIdleCallback((function(){t(n)})):setTimeout((function(){t(n)}),0))};if(Se=!0,console.log("[lzd-h5-itrace 2.0] init images perf monitor"),window.isTrace2&&window.__wpk.setConfig(e),window.__wpk||be(e),window.performance&&window.PerformanceObserver)window.performance.getEntriesByType("resource").forEach((function(e){n(e)})),new PerformanceObserver((function(e){e.getEntries().forEach((function(e){n(e)}))})).observe({entryTypes:["resource"]})}};var ke=function(){var e=[],t=screen.width*screen.height,n=null,o=!1,i=!1,r=["SCRIPT","LINK","SVG","IMG","VIDEO"],a=[];function c(e){if(!e)return"";var t=e.nodeName.toLowerCase();return""!==e.id?"".concat(t,"#").concat(e.id):"string"==typeof e.className?"".concat(t,".").concat(e.className.replace(" ",".")):t}function s(e){var t=[];y(e,(function(e){y(e.addedNodes,(function(e){1===e.nodeType&&t.push(e)}))})),t.length>0&&g(t.concat([]))}var l=null;function u(e){o||(i=!0,n&&clearTimeout(n),l.disconnect(),l.takeRecords(),setTimeout((function(){o=!0,v(e)}),1e3))}var d=function(){};function p(t,n){var o=0===e.length,i=screen.width,r=screen.height,a=document.documentElement,c=a?Math.min(a.clientHeight,r):r,s=a?Math.min(a.clientWidth,i):i,l=t.left+t.width,u=t.top+t.height,d=Math.round(.02*Math.min(i,r)),p=Math.round(.05*r);return o?t.width>=n||t.height>=n?d:l>=d&&s-t.left>=d&&u>=p&&c-t.top>=p:t.width>=2*d&&t.height>=2*d&&l>=p&&s-t.left>=p&&u>=p&&c-t.top>2*p}function f(e,t,n){var o=n||0;return y(e,(function(e){o=t(e,o)})),o}function w(e){var t=function(){e.lastTime=Math.max(_(),e.lastTime),e.c=document.getElementsByTagName("*").length,m()};window.requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,0)}function g(n){var i=_(),s={createTime:i,lastTime:i,wait:0,piece:[],v:0,c:document.getElementsByTagName("*").length};y(n,(function(e){(function(e){for(var t=a.length,n=null,o=0;o<t;o++)if((n=a[o])&&n.contains&&n.contains(e))return!0;return!!e.hasAttribute("ignoreFspCollection")&&(a.push(e),!0)})(e)||function(e,n,i){var a=e.piece,s=document.documentElement.scrollTop||window.pageYOffset||document.body&&document.body.scrollTop||0,l=document.documentElement.scrollLeft||window.pageXOffset||document.body&&document.body.scrollLeft||0,u=i?null:n.getBoundingClientRect(),d=i||{type:0,className:"",top:u.top+s,left:u.left+l,width:u.width,height:u.height,domPath:c(n)},g=n.offsetParent;g&&g.offsetWidth<g.scrollWidth&&(d.width=Math.min(g.offsetWidth,d.width)),g&&g.offsetHeight<g.scrollHeight&&(d.height=Math.min(g.offsetHeight,d.height));var h=n.tagName;if(-1!=r.indexOf(h.toUpperCase())&&"IMG"==h){var v=0;if(d.width=Math.max(d.width,1),d.height=Math.max(d.height,1),d.type=1,p(d)){var y=function(){if(o)n.removeEventListener("load",y,!0);else{v++,e.wait-=1;var i=n.getBoundingClientRect(),r=_();p(d,!0)&&(v<=1||r<=1e3)?(d.width=i.width,d.height=i.height,e.lastTime=Math.max(r,e.lastTime),d.size=i.width*i.height,d.v=d.size/t,e.v=f(e.piece,(function(e,t){return e.v+t}),0),w(e)):m()}},b=function(){o?n.removeEventListener("error",b,!0):(e.wait-=1,p(d)?(e.lastTime=Math.max(_(),e.lastTime),0===e.wait&&(e.v=f(e.piece,(function(e,t){return e.v+t}),0),w(e))):m())};e.wait+=1,n.addEventListener("load",y,!0),n.addEventListener("error",b,!0)}}var T={};if(window.getComputedStyle&&("none"===(T=window.getComputedStyle(n,null)).display||"fixed"===T.position))return a;if(p(d)){var S=T.backgroundImage||"",O=/url\(['"]?(.*?)['"]?\)/i;if(O.test(S)&&(S=S.replace(O,"$1"),!/^data:/i.test(S)&&S!==location.href)){e.wait+=1;var k=document.createElement("img");k.onload=function(){e.wait-=1,e.lastTime=Math.max(_(),e.lastTime),0===e.wait&&w(e)},k.src=S}(function(e,t){var n=null;for(var o in e)if(n=e[o],t.top>=n.top&&t.left>=n.left&&t.top+t.height<=n.top+n.height&&t.left+t.width<=n.left+n.width)return!0;return!1})(a,d)||(d.size=d.width*d.height,d.v=d.size/t,e.v+=d.v,d.size&&a.push(d))}}(s,e)})),s.piece.length>0&&(e.push(s),w(s))}function m(){if(!i&&!o){n&&clearTimeout(n),n=setTimeout((function(){u()}),3e3);for(var t=null,r=null,a=0,c=0,s=0,l=0,d=0,p=e.length-1;p>1;p--){if(t=e[p],r=e[p-1],l=Math.floor(100*t.v)/100,c=(d=Math.floor(100*r.v)/100)?Math.abs(l-d)/d:0,(s+=Math.min(t.v,1))>4){u();break}if(c<.5){if(++a>6){u();break}}else a>0&&(a=0)}}}var h=0;function v(t){t&&(o=!0);var n=e.length;if(0!==n){var i=[],r=[],a=[],c=[],s=-1,l=0,p=0,f=0;for(f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,o=e.length-1,i=0;do{var r=e[o],a=e[o-1];if(!(Math.abs(r-a)/r<t))break;i++,o--}while(o>0);return i>=n&&o>0?Math.min(o,e.length-1):e.length-1}(e.map((function(e){return Math.floor(100*e.v)/100}))),r=f>0?e.slice(0,n+2):e;r.length>0;)if(c.push([]),s=r[0].lastTime,l=r[0].c,a=[],p=0,f=0,y(r,(function(e){p+=e.v,f++,e.createTime<=s+200&&(c[c.length-1].push({frame:e}),s=Math.max(s,e.lastTime),l=Math.max(l,e.c)),e.lastTime>s&&a.push(e)})),r=a,p<.02||p/f<.01?h++:h=0,i.push([s,l]),h>=3){i.splice(i.length-3),c.splice(i.length-3),u();break}var w=i.length-1;0!==h&&w>=h&&(w-=h),w=i[w];var g=null,m=null;l=null;try{var v;w&&(g=w[0],l=w[1],function(e,t,n){if(!window.dispatchEvent||!window.CustomEvent)return;var o={cost:t,timestamp:e,domSize:n},i=new CustomEvent("jstracker.fsp",{detail:o});window.__itrace_fsp_detail__=o,window.dispatchEvent(i)}(m=performance.timing.navigationStart+g,g,l)),window.resultFrames=(v=[]).concat.apply(v,c).map((function(e,t){var n;return e.index=t+1,e.uuid=(n=8,Number(Math.random().toString().substr(2,n)+Date.now()).toString(36)),e})),window.__wpk&&window.__wpk.report&&window.__wpk.report({category:208,msg:"FSP分片信息上报",bl1:JSON.stringify(window.resultFrames)}),d&&d(m,g,l)}catch(e){}}}function _(){return performance.now()}function y(e,t){if(Array.prototype.forEach)Array.prototype.forEach.call(e,t);else for(var n=e.length,o=0;o<n;o++)t(e[o],o)}return{reset:function(){n&&clearTimeout(n),n=null,o=!1,i=!1},install:function(){window.performance&&window.MutationObserver&&((l=new MutationObserver(s)).observe(document.documentElement,{childList:!0,subtree:!0}),g(document.querySelectorAll("BODY > *")),setTimeout((function(){u(!0)}),3e4))},onReport:function(e){e&&"function"==typeof e&&(d=e)},forceStop:function(){v(!0)}}}(),Ee=ke,xe=!1,Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isSPA;if(!xe||t){xe=!0,window.__wpk||be(e);var n="",o=(window.lzdiTraceLifeCircle||{}).FSPStart,i=function(t){var o=t.timestamp,i=t.time,r=t.domSize,a=t.ssrTime,c=void 0===a?"":a,s=window.lzdiTraceLifeCircle||{},l=s.lzdiTraceShareFspTime,u=s.FSPEnd;if(console.log("[fsp-report 2.0]",o,i,r,window.preLoadTime,c),window.__lzd_fsp_done=!0,window.__wpk&&window.__wpk.report){var d=Math.floor(i)-Math.floor(window.preLoadTime||0);if(window.__lzd_fsp_value=d,d>0&&d<2e4){var p=e.msg||"自定义首屏";p=S(p);var f=window.performance.getEntriesByType("navigation")[0],w=f&&f.responseEnd;window.__wpk.report({category:e.category||200,msg:p,wl_avgv1:d,wl_avgv2:window.__SSR_FS_TIME||void 0,wl_avgv3:w,wl_avgv4:c||void 0,c1:d,c2:i,c3:window.preLoadTime||"-",c4:n,c5:window.__SSR_TRACE_ID||"-"}),"function"==typeof l&&l({fspTime:d,preLoadTime:window.preLoadTime,url:location.href}),"function"==typeof u&&u()}else{var g=d<0?"负值":"极大值 (>20s)";window.__wpk.report({category:e.category||200,msg:"".concat(g),c1:d,c2:i,c3:window.preLoadTime||"-",c4:n})}}};if("function"==typeof o&&o(),t)Ee.reset(),Ee.install(),Ee.onReport((function(e,t,n){console.log("spa fsp install onReport"),i({timestamp:e,time:t,domSize:n})}));else if(window.fspTracker){window.__isSSR&&(n="SourcePageSSR");var r=function(e){var t=e.cost,n=e.timestamp,o=e.domSize,r=e.ssrTime;i({time:t,timestamp:n,domSize:o,ssrTime:r})};window.__FSP?r(window.__FSP):window.fspTracker.listeners.push((function(e){r(e)}))}else if(!0===window.rocket_pre_hot)Ee.install(),Ee.onReport((function(e,t,n){i({timestamp:e,time:t,domSize:n})}));else if(window.lzdFspTrackerPlugin){var a=window.__itrace_fsp_detail__;a?i({timestamp:a.timestamp,time:a.cost,domSize:a.domSize}):window.lzdFspTrackerPlugin.onReport((function(e,t,n){i({timestamp:e,time:t,domSize:n})}))}else Ee.install(),Ee.onReport((function(e,t,n){i({timestamp:e,time:t,domSize:n})}))}},Ie=["scene","status","value","args"],je=[/c\.go\-mpulse\.net/,/ds\-aksb\-a\.akamaihd\.net\/RRT/,/s\.akamaihd\.net\/eum\/getdns\.txt/,/pre\-wormhole/],Le=["SUCCESS","UNION_NOT_MATCH_FREQUENCY","FAIL_SYS_TOKEN_EMPTY","FAIL_SYS_ILLEGAL_ACCESS","FAIL_SYS_TOKEN_EXOIRED","FAIL_SYS_TOKEN_ILLEGAL"],Ce={SG:"acs-m.lazada.sg",ID:"acs-m.lazada.co.id",PH:"acs-m.lazada.com.ph",VN:"acs-m.pages.lazada.vn",TH:"acs-m.pages.lazada.co.th",MY:"acs-m.pages.lazada.com.my"};function Ae(e){if(n=e,"[object Array]"===Object.prototype.toString.call(n)){var t=e&&e.length&&e[0].split("::");return t&&t[1]?{key:t[0],displayMessage:t[1]}:-1!==e[0].indexOf("FAIL_SYS")||-1!==e[0].indexOf("SYSTEM_ERROR")||-1!==e[0].indexOf("UNKNOWN_FAIL_CODE")||-1!==e[0].indexOf("TIMEOUT")?{key:t[0],displayMessage:"Network Error"}:{key:e[0],displayMessage:"Unknown Error"}}var n;return{key:e,displayMessage:"Unknown Error"}}var Re,De,Ne,Me,ze,qe=function(e,t,n,o,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};je.some((function(t){return t.test(e)}))||window.__wpk.reportApi(u({msg:i,url:e,method:t,status:o,spent:n,response:o},r),{})},Fe=function(e){var t,n,o=e.params,i=e.options,r=e.spent,a=e.performanceNow,c="",s=i.retJson,l=void 0===s?{}:s,u=i.path,d=i.prefix,p=i.subDomain,f=i.pageDomain,w=l.responseHeaders,g=void 0===w?"":w,m=l.ret,h=k(g),v=Ae(m),_=v.displayMessage,y=o.type||"",b=l.v||o.v||"",T=o["x-i18n-regionID"]||"-",S=Ce[T.toUpperCase()]||T,O=l.api||o.api||"";O=O.toLowerCase(),t=o.ext_headers&&o.ext_headers["x-uid"]||"",n=Le.includes(v.key)?200:0,c=u?"https:".concat(u):p&&f?"https://".concat(d?d+".":"").concat(p,".").concat(f,"/gw/").concat(O,"/").concat(b):"https://".concat(S,"/gw/").concat(O,"/").concat(b),qe(c,y,r,n,v.key,{c1:t,c2:h,c3:_,c4:a,c5:v.key,c6:window.location.origin+window.location.pathname})},He=function(e){var t;((window.__iTraceMtopQueue||[]).forEach((function(e){Fe(e)})),window.__iTraceMtopQueue=[],window.iLogger&&(window.iLogger.mtopReport=Fe),window.isMtopMiddlewareReady)||(window.__wpk||be(e),console.log("--- iLoggerMtopPluginInit ---"),window,(t=window.lib||(window.lib={}))&&t.mtop&&!t.mtop.ERROR?(t.mtop.middlewares.push((function(e){var t=this.params,n=this.options,o=n.querystring,i=parseInt((void 0===o?{}:o).t)||Date.now(),r=void 0;return performance&&"function"==typeof performance.now&&(r=Math.floor(performance.now())-Math.floor(window.preLoadTime||0)),e().then((function(){var e=(n.results[0]||{}).stat,o=(void 0===e?{}:e).oneWayTime||Date.now()-i;Fe({params:t,options:n,spent:o,performanceNow:r})}))})),window.isMtopMiddlewareReady=!0,console.log("[lzd-h5-itrace] mtop itrace plugin init success!")):console.warn("[lzd-h5-itrace] Mtop 没有初始化，无法添加 Mtop Itrace 监控插件！请参考 Mtop 文档 http://gitlab.alibaba-inc.com/mtb/lib-mtop ",t))},Be=He,Ke=[".webp",".png",".jpg",".gif"],We=!1,Ge=function(e){if(window.IMG_PRELOAD_PROFILE_PLUGIN&&!We&&(We=!0,console.log("[lzd-h5-itrace 2.0] init preload profile monitor"),window.isTrace2&&window.__wpk.setConfig(e),window.__wpk||be(e),window.performance&&window.PerformanceObserver)){var t,n=window.performance.getEntriesByType("resource")||[],o=[],i=0,r=n.filter((function(e){if("link"===e.initiatorType&&Ke.some((function(t){return e.name.endsWith(t)}))&&o.push(e),"link"===e.initiatorType&&e.name.endsWith(".css"))return i+=e.duration,t?e.responseEnd<t&&(t=e.responseEnd):t=e.responseEnd,!0}));if(!(r&&r.length&&o&&o.length))return;var a=[],c=[],s=0,l=0;o.forEach((function(e){e.requestStart>t?(a.push(e),s+=e.duration):(c.push(e),l+=e.duration)}));try{window.__wpk.report({category:206,msg:"Image Preload Profile",w_succ:a.length<1?1:0,wl_avgv1:c.length,wl_avgv2:a.length,wl_avgv3:i/(r.length||1),wl_avgv4:l/(c.length||1),wl_avgv5:s/(a.length||1),bl1:c.map((function(e){return e.name})).join(";"),bl2:a.map((function(e){return e.name})).join(";")})}catch(e){}}},Ue=-1,Je=function(e){addEventListener("pageshow",(function(t){t.persisted&&(Ue=t.timeStamp,e(t))}),!0)},Ve=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},Xe=function(){var e=Ve();return e&&e.activationStart||0},Ye=function(e,t){var n=Ve(),o="navigate";return Ue>=0?o="back-forward-cache":n&&(document.prerendering||Xe()>0?o="prerender":document.wasDiscarded?o="restore":n.type&&(o=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:o}},$e=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var o=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return o.observe(Object.assign({type:e,buffered:!0},n||{})),o}}catch(e){}},Qe=function(e,t,n,o){var i,r;return function(a){t.value>=0&&(a||o)&&((r=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=r,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},Ze=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},et=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},tt=function(e){var t=!1;return function(){t||(e(),t=!0)}},nt=-1,ot=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},it=function(e){"hidden"===document.visibilityState&&nt>-1&&(nt="visibilitychange"===e.type?e.timeStamp:0,at())},rt=function(){addEventListener("visibilitychange",it,!0),addEventListener("prerenderingchange",it,!0)},at=function(){removeEventListener("visibilitychange",it,!0),removeEventListener("prerenderingchange",it,!0)},ct=function(){return nt<0&&(nt=ot(),rt(),Je((function(){setTimeout((function(){nt=ot(),rt()}),0)}))),{get firstHiddenTime(){return nt}}},st=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},lt=[1800,3e3],ut=function(e,t){t=t||{},st((function(){var n,o=ct(),i=Ye("FCP"),r=$e("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(r.disconnect(),e.startTime<o.firstHiddenTime&&(i.value=Math.max(e.startTime-Xe(),0),i.entries.push(e),n(!0)))}))}));r&&(n=Qe(e,i,lt,t.reportAllChanges),Je((function(o){i=Ye("FCP"),n=Qe(e,i,lt,t.reportAllChanges),Ze((function(){i.value=performance.now()-o.timeStamp,n(!0)}))})))}))},dt=[.1,.25],pt=0,ft=1/0,wt=0,gt=function(e){e.forEach((function(e){e.interactionId&&(ft=Math.min(ft,e.interactionId),wt=Math.max(wt,e.interactionId),pt=wt?(wt-ft)/7+1:0)}))},mt=function(){return Re?pt:performance.interactionCount||0},ht=function(){"interactionCount"in performance||Re||(Re=$e("event",gt,{type:"event",buffered:!0,durationThreshold:0}))},vt=[],_t=new Map,yt=0,bt=[],Tt=function(e){if(bt.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=vt[vt.length-1],n=_t.get(e.interactionId);if(n||vt.length<10||e.duration>t.latency){if(n)e.duration>n.latency?(n.entries=[e],n.latency=e.duration):e.duration===n.latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e);else{var o={id:e.interactionId,latency:e.duration,entries:[e]};_t.set(o.id,o),vt.push(o)}vt.sort((function(e,t){return t.latency-e.latency})),vt.length>10&&vt.splice(10).forEach((function(e){return _t.delete(e.id)}))}}},St=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=tt(e),"hidden"===document.visibilityState?e():(n=t(e),et(e)),n},Ot=[200,500],kt=function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},st((function(){var n;ht();var o,i=Ye("INP"),r=function(e){St((function(){e.forEach(Tt);var t=function(){var e=Math.min(vt.length-1,Math.floor((mt()-yt)/50));return vt[e]}();t&&t.latency!==i.value&&(i.value=t.latency,i.entries=t.entries,o())}))},a=$e("event",r,{durationThreshold:null!==(n=t.durationThreshold)&&void 0!==n?n:40});o=Qe(e,i,Ot,t.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),et((function(){r(a.takeRecords()),o(!0)})),Je((function(){yt=mt(),vt.length=0,_t.clear(),i=Ye("INP"),o=Qe(e,i,Ot,t.reportAllChanges)})))})))},Et=[2500,4e3],xt={},Pt={passive:!0,capture:!0},It=new Date,jt=function(e,t){De||(De=t,Ne=e,Me=new Date,At(removeEventListener),Lt())},Lt=function(){if(Ne>=0&&Ne<Me-It){var e={entryType:"first-input",name:De.type,target:De.target,cancelable:De.cancelable,startTime:De.timeStamp,processingStart:De.timeStamp+Ne};ze.forEach((function(t){t(e)})),ze=[]}},Ct=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){jt(e,t),i()},o=function(){i()},i=function(){removeEventListener("pointerup",n,Pt),removeEventListener("pointercancel",o,Pt)};addEventListener("pointerup",n,Pt),addEventListener("pointercancel",o,Pt)}(t,e):jt(t,e)}},At=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,Ct,Pt)}))},Rt=[100,300],Dt=function(e){return/use_ssr=true/.test(window.location.href)?e-(O().uprproxy_time||0):window.__IS_TRADITION_SSR?e:window.__IS_KANGAROO_SSR?e-(window.prehotShowUpTime||0):e},Nt={};function Mt(e){if(window.__wpk&&!Nt[e.name]){Nt[e.name]=!0;try{var t=e.value;"LCP"===e.name&&(t-=window.preLoadTime||0);var n={category:1028,wl_avgv1:t,c1:window.location.pathname,c2:($pegasus||{}).id,c3:e.name,c4:e.rating};window.__wpk.report(n)}catch(e){console.log("reportwv error")}}}var zt=function(e){!function(e,t){t=t||{},st((function(){var n,o=ct(),i=Ye("LCP"),r=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<o.firstHiddenTime&&(i.value=Math.max(e.startTime-Xe(),0),i.entries=[e],n())}))},a=$e("largest-contentful-paint",r);if(a){n=Qe(e,i,Et,t.reportAllChanges);var c=tt((function(){xt[i.id]||(r(a.takeRecords()),a.disconnect(),xt[i.id]=!0,n(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return St(c)}),{once:!0,capture:!0})})),et(c),Je((function(o){i=Ye("LCP"),n=Qe(e,i,Et,t.reportAllChanges),Ze((function(){i.value=performance.now()-o.timeStamp,xt[i.id]=!0,n(!0)}))}))}}))}((function(e){F({group:"web_vitals",event:"web_vitals_lcp",lcp_value:Dt(e.value)}),Mt(e)})),ut((function(e){F({group:"web_vitals",event:"web_vitals_fcp",fcp_value:Dt(e.value)}),Mt(e)})),function(e,t){t=t||{},st((function(){var n,o=ct(),i=Ye("FID"),r=function(e){e.startTime<o.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},a=function(e){e.forEach(r)},c=$e("first-input",a);n=Qe(e,i,Rt,t.reportAllChanges),c&&(et(tt((function(){a(c.takeRecords()),c.disconnect()}))),Je((function(){var o;i=Ye("FID"),n=Qe(e,i,Rt,t.reportAllChanges),ze=[],Ne=-1,De=null,At(addEventListener),o=r,ze.push(o),Lt()})))}))}((function(e){F({group:"web_vitals",event:"web_vitals_fid",fid_value:e.value}),Mt(e)})),kt((function(e){F({group:"web_vitals",event:"web_vitals_inp",inp_value:e.value}),Mt(e)})),function(e,t){t=t||{},ut(tt((function(){var n,o=Ye("CLS",0),i=0,r=[],a=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=r[0],n=r[r.length-1];i&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,r.push(e)):(i=e.value,r=[e])}})),i>o.value&&(o.value=i,o.entries=r,n())},c=$e("layout-shift",a);c&&(n=Qe(e,o,dt,t.reportAllChanges),et((function(){a(c.takeRecords()),n(!0)})),Je((function(){i=0,o=Ye("CLS",0),n=Qe(e,o,dt,t.reportAllChanges),Ze((function(){return n()}))})),setTimeout(n,0))})))}((function(e){F({group:"web_vitals",event:"web_vitals_cls",cls_value:e.value}),Mt(e)}))},qt=x(),Ft={},Ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(P(location.host)){var t={selfDefineFSP:!0,mtopPluginInit:!0,imagesPerf:!0,assetPerf:!0,didMountTimeReport:!0,preloadProfile:!0,webVitals:!0,fps:!0},n=document.head.querySelector('meta[name="lzd-itrace-close-auto-monitor"]');if(n&&n.getAttribute("content"))n.getAttribute("content").split(",").forEach((function(e){var n=e.trim();t[n]=!1}));!function(){window.lzdiTraceLifeCircle=Object.assign({},window.lzdiTraceLifeCircle);var e=window.performance.timing||{};window.lzdiTraceLifeCircle.NativePrefetchEnd=function(){Y({event:"native_prefetch_end",time:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)||Date.now()})},window.lzdiTraceLifeCircle.FirstScreenRenderingStart=function(){Y({event:"first_screen_rendering_start",time:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)||e.responseStart})},window.lzdiTraceLifeCircle.FirstScreenRenderingEnd=function(){Y({event:"first_screen_rendering_end",time:Date.now(),costTime:Date.now()-(V.first_screen_rendering_start||e.responseStart)})},window.lzdiTraceLifeCircle.FSPStart=function(){Y({event:"fsp_start",time:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)||e.responseStart})},window.lzdiTraceLifeCircle.FSPEnd=function(){Y({event:"fsp_end",time:Date.now(),costTime:Date.now()-(V.fsp_start||e.responseStart)})},window.lzdiTraceLifeCircle.FetchSSRDataStart=function(){Y({event:"fetch_ssr_data_start",time:(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)||e.domComplete})},window.lzdiTraceLifeCircle.FetchSSRDataEnd=function(){Y({event:"fetch_ssr_data_end",time:Date.now(),costTime:Date.now()-(V.fetch_ssr_data_start||e.domComplete)})},window.lzdiTraceLifeCircle.FetchFirstScreenDataStart=function(e){e&&Y({event:"fetch_first_screen_data_start",time:e})},window.lzdiTraceLifeCircle.FetchFirstScreenDataEnd=function(e){e&&Y({event:"fetch_first_screen_data_end",time:e,costTime:e-V.fetch_first_screen_data_start})},window.lzdiTraceLifeCircle.PageRenderingEnd=function(){Y({event:"page_rendering_end",time:Date.now(),costTime:Date.now()-(V.page_rendering_start||e.responseStart)})},console.log("[lzd-h5-itrace] lifecyle report plugin ready"),document.addEventListener("DOMContentLoaded",(function(){Y(X)}))}(),t.selfDefineFSP?Pe(e):console.log("[lzd-h5-itrace] close auto run selDefineFSP"),t.imagesPerf?Oe(e):console.log("[lzd-h5-itrace] close auto run iLoggerImagesPerf"),t.assetPerf?function(){if(!_){var e=function(e){var t=e.name,n=e.responseStart,i=e.fetchStart,r=e.domainLookupEnd,a=e.domainLookupStart,c=e.requestStart,s=e.responseEnd,l=e.connectEnd,u=e.connectStart,d=e.transferSize,p=e.decodedBodySize,f=e.startTime;try{var w={category:204,msg:new URL(t).hostname,wl_avgv1:n-i,wl_avgv2:r-a,wl_avgv3:l-u,wl_avgv4:n-c,wl_avgv5:s-n,wl_avgv6:s-i,wl_avgv7:d,wl_avgv8:p,wl_avgv9:f,wl_avgv10:Math.floor(window.preLoadTime||0),wl_avgv11:f-Math.floor(window.preLoadTime||0)>0?f-Math.floor(window.preLoadTime||0):f,c1:t,c2:0===n?"true":"false",bl_1:o,sampleRate:.05};n>=0&&window.__wpk.report(w)}catch(e){}},t=function(t){window.requestIdleCallback?window.requestIdleCallback((function(){e(t)})):setTimeout((function(){e(t)}),0)},n=function(e){var n=e.filter((function(e){var t=e.initiatorType,n="css"===t&&e.name.endsWith(".css"),o="link"===t&&(e.name.endsWith(".js")||e.name.endsWith(".css"));return"script"===t||n||o}));n.forEach(t)};if(_=!0,!window.__wpk)return;var o=(v()||{}).wh_pid||location.pathname;if(console.log("[lzd-h5-itrace] init asset perf monitor"),window.performance&&window.PerformanceObserver){var i="resource",r=window.performance.getEntriesByType(i);n(r),new PerformanceObserver((function(e){n(e.getEntries())})).observe({entryTypes:[i]})}}}():console.log("[lzd-h5-itrace] close auto run iLoggerAssetPerf"),window.lib&&window.lib.mtop&&t.mtopPluginInit?Be(e):console.log("[lzd-h5-itrace] close auto run mtopPluginInit"),t.didMountTimeReport?W():console.log("[lzd-h5-itrace] disable didMountTimeReport"),t.preloadProfile?Ge(e):console.log("[lzd-h5-itrace] close preload profile plugin"),t.webVitals?zt():console.log("[lzd-h5-itrace] disable web vitals plugin"),window.itracePluginInitialized=!0}else console.warn("[lzd-h5-itrace] 非法域名")};window&&(function(e){if(!window.isTrace2){window.addEventListener("oniLoggerMtopPluginInit",(function(e){He(e.detail)}),!1);var t=!0;window.lib?window.lib.mtop&&(t=!1):window.lib={},t&&Object.defineProperty(window.lib,"mtop",{get:function(){return window.__lzdlib_mtop__},set:function(t){window.__lzdlib_mtop__=t,Object.defineProperty(window.lib.mtop,"middlewares",{get:function(){return window.__lzdlib_mtop_middlewares__},set:function(t){var n=new CustomEvent("oniLoggerMtopPluginInit",{detail:e||{}});window.__lzdlib_mtop_middlewares__=t,window.dispatchEvent(n)},configurable:!0,enumerable:!0})},configurable:!0,enumerable:!0})}}(Ft),qt&&(be({pid:qt}),Ht({pid:qt}))),e.iLoggerDataTrack=function(e){var t=e.scene,n=void 0===t?"unkown":t,o=e.status,i=void 0===o?1:o,r=e.value,a=void 0===r?0:r,c=e.args,s=void 0===c?"":c,l=d(e,Ie);if(/1|0/.test(i))if(/^\d+$/.test(a)){var p={w_succ:i,wl_avgv1:a,msg:n,bl1:s};Object.keys(l).forEach((function(e){/^filter([0-9]|10)$/.test(e)&&(p[e.replace("filter","c")]=l[e])})),window.__wpk&&window.__wpk.report&&window.__wpk.report(u({category:207},p))}else console.error("[lzd-h5-itrace] iLoggerDataTrack value should be correct integer");else console.error("[lzd-h5-itrace] iLoggerDataTrack status should be 0 or 1")},e.iLoggerInit=be,e.iLoggerIntegrate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";try{t=be(e)}catch(e){console.log("[lzd-h5-itrace] catch iTrace sdk error, make program go on!")}return Ht(e),Ft=e,t},e.iLoggerMtopPluginInit=Be,e.iLoggerReportApi=qe,e.iLoggerSelfDefineFSP=Pe,Object.defineProperty(e,"__esModule",{value:!0})}));
